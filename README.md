# DeepCanola
Code and model weights associated with the publication _DeepCanola: Phenotyping Brassica Pods Using Semi-Synthetic Data and Active Learning_. 

Link to DOI containing generated datasets, data pools used to generate datasets, real-world datasets and phenotype data outputs generated by the model: [10.5281/zenodo.13903900](https://doi.org/10.5281/zenodo.13903900).

Training and inference scripts in `train.sh` and `inference.sh`.

Dataset generation script available in `utils/generate_dataset.sh`, and takes arguments to a directory of images (containing a single object per image), an argument to a directory of masks (binary truth masks with the same names as the images folder with ``_mask.png`` as the suffix), and an argument to a directory of backgrounds.

Model weights available at: [*link*](https://www.dropbox.com/scl/fi/0gvfptco8qggsdimoybmi/deepcanola.pth?rlkey=9n84rdk8dlpbwm3t1js655d88&dl=0)

# DeepCanola training

Loss and AP graphs of training DeepCanola model (not the same as model provided here, instead a retrained model with identical training parameters with performance Â± 0.001 AP in both metrics to DeepCanola model, shown for illustrative purposes.)

Loss: 

<img src="https://github.com/kieranatkins/deepcanola/blob/main/loss.png?raw=True" alt="Loss graph" height=400 width=500>


AP:

<img src="https://github.com/kieranatkins/deepcanola/blob/main/ap.png?raw=True" alt="AP graph" height=400 width=500>
